/*! @license pzpr.js v0.11.1 (c) 2009-2019 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */

!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["hebi"],{MouseEvent:{use:!0,inputModes:{edit:["number","direc","clear"],play:["number","dragnum+","dragnum-","objblank","clear"]},mouseinput:function(){"objblank"===this.inputMode?this.inputDot_snakes():0===this.inputMode.indexOf("dragnum")?this.dragnumber_snakes():this.common.mouseinput.call(this)},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&(this.inputDot_snakes()||this.dragnumber_snakes()):this.puzzle.editmode&&(this.mousestart||this.mousemove&&this.notInputted())&&this.inputdirec(),this.mouseend&&this.notInputted()&&this.inputqnum_snakes()},dragnumber_snakes:function(){var a=this.getcell();if(!a.isnull&&a!==this.mouseCell){if(this.mouseCell.isnull)return-1!==a.qnum?this.inputData=-3:-1!==a.anum?this.inputData=a.anum:1===a.qsub?this.inputData=-2:this.inputData=10,void(this.mouseCell=a);if(-3===this.inputData&&(-1!==a.qnum||(-1!==a.anum?this.inputData=-2:1===a.qsub?this.inputData=10:this.inputData=-2)),-1===a.qnum){if(this.inputData>=1&&this.inputData<=5){if("dragnum+"===this.inputMode||"auto"===this.inputMode&&"left"===this.btn?this.inputData++:this.inputData--,!(this.inputData>=1&&this.inputData<=5))return;a.setQdir(0),a.setAnum(this.inputData),a.setQsub(0)}else if(-2===this.inputData)a.setAnum(-1),a.setQsub(1);else{if(10!==this.inputData)return;a.setAnum(-1),a.setQsub(0)}this.mouseCell=a,a.draw()}}},inputDot_snakes:function(){if("auto"===this.inputMode&&("right"!==this.btn||null!==this.inputData&&this.inputData>=0))return!1;var a=this.getcell();if(a.isnull||a===this.mouseCell)return this.inputData<0;if(null===this.inputData){var b=!1;if(-1===a.anum&&(this.inputData=1!==a.qsub?-2:-3,b=!0),"auto"===this.inputMode)return b}return a.setAnum(-1),a.setQsub(-2===this.inputData?1:0),a.draw(),this.mouseCell=a,!0},inputqnum_snakes:function(){this.getcell().isnull||(this.mouseCell=this.board.emptycell,this.inputqnum())}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(a){return!a.match(/shift/)&&this.moveTCell(a)},keyinput:function(a){this.puzzle.editmode&&this.key_inputdirec(a)||(!this.puzzle.playmode||"q"!==a&&"-"!==a||(a="s1"),this.key_inputqnum(a))}},Cell:{maxnum:5,minnum:function(){return this.puzzle.playmode?1:0},draw:function(){this.puzzle.getConfig("snakebd")?this.puzzle.painter.paintRange(this.bx-2,this.by-2,this.bx+2,this.by+2):this.getaddr().draw()}},Board:{hasborder:1,addExtraInfo:function(){this.snakemgr=this.addInfoList(this.klass.AreaSnakeGraph)}},BoardExec:{adjustBoardData:function(a,b){this.adjustNumberArrow(a,b)}},"AreaSnakeGraph:AreaGraphBase":{enabled:!0,relation:{"cell.anum":"node"},setComponentRefs:function(a,b){a.snake=b},getObjNodeList:function(a){return a.snakenodes},resetObjNodeList:function(a){a.snakenodes=[]},isnodevalid:function(a){return a.anum>0},isedgevalidbynodeobj:function(a,b){return-1===a.anum==(-1===b.anum)&&1===Math.abs(a.anum-b.anum)}},Graphic:{hideHatena:!0,gridcolor_type:"LIGHT",fgcellcolor_func:"qnum",fontShadecolor:"white",numbercolor_func:"fixed_shaded",paint:function(){this.drawBGCells(),this.drawDotCells_hebiichigo(),this.drawDashedGrid(),this.drawBorders(),this.drawQuesCells(),this.drawArrowNumbers(),this.drawAnsNumbers(),this.drawChassis(),this.drawCursor()},getBorderColor:function(a){if(!this.puzzle.getConfig("snakebd"))return!1;var b=a.sidecell[0],c=a.sidecell[1];return b.isnull||c.isnull||-1!==b.qnum||-1!==c.qnum||-1===b.anum&&-1===c.anum||-1===b.anum==(-1===c.anum)&&1===Math.abs(b.anum-c.anum)?null:!b.trial&&-1!==b.anum||!c.trial&&-1!==c.anum?this.qanscolor:this.trialcolor},drawDotCells_hebiichigo:function(){for(var a=this.vinc("cell_dot","crispEdges",!0),b=Math.max(.075*this.cw,2),c=this.range.cells,d=0;d<c.length;d++){var e=c[d];a.vid="c_dot_"+e.id,1===e.qsub?(a.fillStyle=e.trial?this.trialcolor:"rgb(255, 96, 191)",a.fillRectCenter(e.bx*this.bw,e.by*this.bh,b,b)):a.vhide()}}},Encode:{decodePzpr:function(a){this.decodeArrowNumber16()},encodePzpr:function(a){this.encodeArrowNumber16()}},FileIO:{decodeData:function(){this.decodeCellDirecQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeCellDirecQnum(),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkNumberExist","checkSnakeSize","checkOtherAnsNumberInRoom","checkSideCell_snakes","checkArrowNumber","checkSnakesView"],checkSnakeSize:function(){this.checkAllArea(this.board.snakemgr,function(a,b,c,d){return 5===c},"bkSizeNe5")},checkOtherAnsNumberInRoom:function(){this.checkDifferentNumberInRoom_main(this.board.snakemgr,this.isDifferentAnsNumberInClist)},checkSideCell_snakes:function(){for(var a=!0,b=this.board,c=0;c<b.cell.length;c++){var d=b.cell[c],e=null,f=d.adjacent.right,g=d.adjacent.bottom;if(d.snake&&(!f.isnull&&f.snake&&d.snake!==f.snake?e=f:!g.isnull&&g.snake&&d.snake!==g.snake&&(e=g),e)){if(a=!1,this.checkOnly)break;d.snake.clist.seterr(1),e.snake.clist.seterr(1)}}a||this.failcode.add("bsSnake")},checkArrowNumber:function(){function a(a){return a.isnull||-1!==a.qnum||-1===a.anum}for(var b,c,d=!0,e=this.board,f=0;f<e.cell.length;f++){var g=e.cell[f],h=g.qnum,i=g.qdir;if(!(h<0||0===i)){for(c=g.getaddr(),c.movedir(i,2);function(){return b=c.getc(),!b.isnull&&-1===b.qnum&&-1===b.anum}();)c.movedir(i,2);if(0!==h||a(b)){if(h>0&&(a(b)||b.anum!==h)){if(d=!1,this.checkOnly)break;g.seterr(1),b.seterr(1)}}else{if(d=!1,this.checkOnly)break;g.seterr(1),h<=0&&b.seterr(1)}}}d||this.failcode.add("anNumberNe")},checkSnakesView:function(){for(var a=this.board.snakemgr.components,b=0;b<a.length;b++){var c=a[b].clist,d=c.filter(function(a){return 1===a.anum})[0];if(d){var e,f=d.NDIR,g=d.adjacent;if(e=g.bottom,e.isnull||2!==e.anum||(f=d.UP),e=g.top,e.isnull||2!==e.anum||(f=d.DN),e=g.right,e.isnull||2!==e.anum||(f=d.LT),e=g.left,e.isnull||2!==e.anum||(f=d.RT),f!==d.NDIR){var h=d.getaddr(),i=new this.klass.CellList;for(i.add(d);!d.isnull&&(h.movedir(f,2),d=h.getc(),d.isnull||i.add(d),!d.isnull&&-1===d.qnum&&-1===d.anum););if(!(d.isnull||d.anum<=0||-1!==d.qnum||null===d.snake||d.snake===a[b])){if(this.failcode.add("snakeAttack"),this.checkOnly)break;i.seterr(1),c.seterr(1),d.snake.clist.seterr(1)}}}}}},FailCode:{bkDupNum:["同じ数字が入っています。","A Snake has same plural marks."],bkSizeNe5:["大きさが５ではない蛇がいます。","The size of a snake is not five."],bsSnake:["別々の蛇が接しています。","Other snakes are adjacent."],anNumberNe:["矢印の先にある数字が正しくありません。","There is a wrong number which is in front of the arrowed number."],snakeAttack:["蛇の視線の先に別の蛇がいます。","A snake can see another snake."]}});